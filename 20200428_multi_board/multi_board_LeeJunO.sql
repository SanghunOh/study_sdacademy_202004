-- SQLite

DROP TABLE MULTIBOARD;
DROP TABLE MEMBER;
DROP TABLE PICTURE;
DROP TABLE AUTHORITY;
DROP TABLE MEMBER_AUTHORITY;
DROP TABLE ORGANIZATION;


CREATE TABLE AUTHORITY
(
  AUTHORITY_ID TEXT NOT NULL,
  NAME         TEXT NULL    ,
  PRIMARY KEY (AUTHORITY_ID)
);

CREATE TABLE MEMBER_AUTHORITY
(
  AUTHORITY_ID TEXT NOT NULL,
  MEMBER_ID    TEXT NOT NULL,
  CONSTRAINT FK_AUTHORITY_TO_MEMBER_AUTHORITY
    FOREIGN KEY (AUTHORITY_ID)
    REFERENCES AUTHORITY (AUTHORITY_ID),
    CONSTRAINT FK_MEMBER_TO_MEMBER_AUTHORITY
    FOREIGN KEY (MEMBER_ID)
    REFERENCES MEMBER (MEMBER_ID)
);

CREATE TABLE ORGANIZATION
(
  ORGANIZATION_SEQ REAL NOT NULL,
  NAME             TEXT NULL    ,
  PRIMARY KEY (ORGANIZATION_SEQ)
);

CREATE TABLE MEMBER
(
  MEMBER_ID        TEXT NOT NULL,
  NAME             TEXT NULL    ,
  EMAIL            TEXT NULL    ,  
  ORGANIZATION_SEQ REAL NOT NULL,
  PRIMARY KEY (MEMBER_ID),
  CONSTRAINT FK_ORGANIZATION_TO_MEMBER
  FOREIGN KEY (ORGANIZATION_SEQ)
  REFERENCES ORGANIZATION (ORGANIZATION_SEQ)
);

CREATE TABLE MULTIBOARD
(
  MULTIBOARD_ID TEXT NOT NULL,
  NAME           TEXT NULL    ,
  GENRE          TEXT NULL    ,
  MEMBER_ID      TEXT NOT NULL,
  PRIMARY KEY (MULTIBOARD_ID),
  CONSTRAINT FK_MEMBER_TO_ATTACHFILES
  FOREIGN KEY (MEMBER_ID)
  REFERENCES MEMBER (MEMBER_ID)
);


CREATE TABLE PICTURE
(
  PICTURE_ID     TEXT NOT NULL,
  FILENAME       TEXT NULL    ,
  MULTIBOARD_ID TEXT NOT NULL,
  PRIMARY KEY (PICTURE_ID),
  CONSTRAINT FK_ATTACHFILES_TO_PICTURE
  FOREIGN KEY (MULTIBOARD_ID)
  REFERENCES ATTACHFILES (MULTIBOARD_ID)
);


-- 2020.04.27

INSERT INTO ORGANIZATION VALUES('ITBI','IT Billing');
INSERT INTO ORGANIZATION VALUES('ENGI','Engineering');

INSERT INTO MEMBER VALUES('MEM1','Paul','paul@gmail.com','ITBI');
INSERT INTO MEMBER VALUES('MEM2','Allen','texas@gmail.com','ENGI');
INSERT INTO MEMBER VALUES('MEM3','Teddy','norway@gmail.com','ITBI');

INSERT INTO AUTHORITY VALUES('01','GUEST');
INSERT INTO AUTHORITY VALUES('02','ADMIN');
INSERT INTO AUTHORITY VALUES('03','MANAGER');

INSERT INTO MEMBER_AUTHORITY VALUES('01','MEM1');
INSERT INTO MEMBER_AUTHORITY VALUES('02','MEM1');
INSERT INTO MEMBER_AUTHORITY VALUES('02','MEM2');
INSERT INTO MEMBER_AUTHORITY VALUES('02','MEM3');
INSERT INTO MEMBER_AUTHORITY VALUES('03','MEM1');
INSERT INTO MEMBER_AUTHORITY VALUES('03','MEM2');

-- 

-- 2020.04.28

INSERT INTO MULTIBOARD VALUES('ATTAC1','용감한 가족','한국 영화 장르','MEM1');
INSERT INTO MULTIBOARD VALUES('ATTAC2','용감한 형제','일본 영화 장르','MEM3');
INSERT INTO MULTIBOARD VALUES('ATTAC3','용감한 친척','미국 영화 장르','MEM3');


INSERT INTO PICTURE VALUES('pos1','poster.png','ATTAC1');
INSERT INTO PICTURE VALUES('act1','actor.png','ATTAC1');
INSERT INTO PICTURE VALUES('pos2','poster02.png','ATTAC2');
INSERT INTO PICTURE VALUES('act2','actor02.png','ATTAC2');
INSERT INTO PICTURE VALUES('pos3','poster03.png','ATTAC3');
INSERT INTO PICTURE VALUES('act4','actor03.png','ATTAC3');


SELECT MULTIBOARD.NAME,MULTIBOARD.GENRE,PICTURE.FILENAME,MEMBER.NAME
FROM MULTIBOARD,PICTURE,MEMBER
WHERE MULTIBOARD.MEMBER_ID = MEMBER.MEMBER_ID
AND PICTURE.MULTIBOARD_ID = MULTIBOARD.MULTIBOARD_ID
AND MEMBER.MEMBER_ID ='MEM3';